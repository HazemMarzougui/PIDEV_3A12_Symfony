{% extends 'base.html.twig' %}

{% block body %}

<div class="page-header">
    <h3 class="page-title">Gestion des Utilisateurs</h3>
    <div class="header-actions">
        <a class="nav-link btn btn-success create-new-button" href="{{ path('user_add')}}" id="createbuttonDropdown" aria-expanded="false">+ Cr√©er Utilisateur</a>
    
</div>

<!-- Search Form -->
<div class="search-form">
    {{ form_start(searchForm, {'attr': {'class': 'form-inline my-2 my-lg-0'}}) }}
    {{ form_row(searchForm.searchQuery, {'attr': {'class': 'form-control mr-sm-2', 'placeholder': 'Search'}}) }}
    <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    {{ form_end(searchForm) }}
</div>

              <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Utilisateurs</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Liste des Utilisateurs</li>
                </ol>
              </nav>
            </div>
            <div class="row">
              <div class="col-lg-12 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">Liste des Utilisateurs</h4>
                    <div class="table-responsive" style="height: 400px; overflow-y: auto; overflow-x: auto;">
                <table class="table table-hover">
    <thead>
        <tr>
            <th>ID</th>
            <th>Email</th>
            <th>Password</th>
            <th>Nom</th>
            <th>Prenom</th>
            <th>Telephone</th>
            <th>Adresse</th>
            <th>Date Naissance</th>
            <th>Description</th>
            <th>Modifier</th>
            <th>Supprimer</th>
        </tr>
    </thead>
    <tbody>
        {% for element in c %}
        <tr>
            <td class="text-success">{{ element.id }}</td>
            <td>{{ element.email }}</td>
            <td>{{ element.password }}</td>
            <td>{{ element.nom }}</td>
            <td>{{ element.prenom }}</td>
            <td>{{ element.tel }}</td>
            <td>{{ element.adresse }}</td>
            <td>{{ element.dateNaiss|date('Y-m-d') }}</td>
            <td class="text-warning">{{ element.description }}</td>
            <td>
<a href="{{ path('user_update', {'id': element.id }) }}" class="btn btn-outline-warning btn-icon-text edit-btn">
    Modifier <i class="mdi mdi-file-check btn-icon-append"></i>
</a>            </td>
            <td>
                <a  href="{{ path('user_delete' , {'id': element.id })}}" class="btn btn-outline-danger btn-icon-text">Supprimer <i class="mdi mdi-file-remove btn-icon-append"></i></a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
                    </div>
                  </div>
                </div>
              </div>

            </div>
            
<h1>User Statistics</h1>
<canvas id="userChart" width="400" height="400"></canvas>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var ctx = document.getElementById('userChart').getContext('2d');
        
        var userChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['Admins', 'Clients'],
                datasets: [{
                    label: 'User Distribution',
                    data: [{{ adminCount }}, {{ clientCount }}],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.5)',
                        'rgba(54, 162, 235, 0.5)',
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                plugins: {
                    legend: {
                        position: 'top', // Adjust legend position
                    },
                },
                layout: {
                    padding: {
                        left: 50,
                        right: 50,
                        top: 50,
                        bottom: 50
                    }
                },
                responsive: false
            }
        });
    });
</script>



</div>

      <!-- Modal -->

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<style>
::-webkit-scrollbar {
    width: 10px;
}

::-webkit-scrollbar-track {
    background-color: #191c24;
    border-radius: 10px;
}

::-webkit-scrollbar-thumb {
    background-color: #888;
    border-radius: 10px;
    border: 2px solid #191c24;
}

#conseilAddedModal {
    position: fixed;
    top: 0px;
    right: 0px;
    z-index: 1050;
}

.scrollbar-color: #888 #191c24;
</style>
{% endblock %}
